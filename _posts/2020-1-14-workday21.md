---
layout:     post
title:      workday21
subtitle:   
date:       2020-1-14
author:     RJ
header-img: 
catalog: true
tags:
    - job

---
<p id = "build"></p>
---

## faspell的检错方式

```python
cand_token, cand_token_prob = cand_tokens[rank]

if cand_token != sentence[j]:
    error = {"error_position": j,
                "original": sentence[j],
                "corrected_to": cand_token,
                "candidates": dict(cand_tokens),
                "confidence": cand_token_prob,
                "similarity": CHAR.similarity(sentence[j], cand_token, weights=weights),
                "sentence_len": len(sentence)}
```


## 使用Faspell测试单句结果：

```
[
    {
        "original_sentence": "标港房企必然条长市场的略",
        "corrected_sentence": "标港房企必然条长市场策略",
        "num_errors": 1,
        "errors": [
            {
                "error_position": 10,
                "original": "的",
                "corrected_to": "策",
                "candidates": {
                    "策": 0.1979513168334961,
                    "规": 0.12672677636146545,
                    "战": 0.1002453938126564,
                    "份": 0.06566258519887924,
                    "格": 0.045202888548374176
                },
                "confidence": 0.1979513168334961,
                "similarity": 0.33666666666666667,
                "sentence_len": 12
            }
        ]
    }
]
```

origin: 标（杆）房企必然（调）（整）市场（战）略

error : 标（港）房企必然（条）（长）市场（的）略

rectify:标（港）房企必然（条）（长）市场（策）略

- 可以看到，标杆这个词应该在训练语料中出现的频率低，可能没有覆盖到。
- 调整 是一个词， 条长在这里与原句差距过大，人的识别也有可能失败，所以应该提高语音识别的精度，让识别结果与真实内容更相近
- 的 纠错的召回词如上所示，根据上下文有5个候选，市场策略、市场规略、市场战略、市场份略、市场格略

分析一下，根据这里市场【MASK】略，的概率，可以看出，模型更倾向于上文推MASK，所以才会出现市场份略，因为预训练模型见到：市场份额的频率可能较高。

这里需要进一步分析：

- 字符error的判定：

- confidence的计算:


- similarity的计算：


